import numpy as np
from pysr import PySRRegressor

X = np.array([[285.6745918480926], [285.65254731794533], [285.56411456761117], [285.645629061265], [285.5313404037731], [285.5152294072959], [285.82596036755183], [285.6850909963241], [285.66847437554287], [285.7942321806458], [285.6173558969908], [285.54829551230875], [285.70513771428756], [285.74306195779934], [285.74186287292093], [285.7417706015542], [285.80290296890576], [285.71421682550385], [285.77180073080535], [285.7223906201329], [285.9607346053532], [285.9677225472197], [285.8857774921239], [285.9456987728691], [285.9169778620971], [285.9211059619261], [285.80089417771], [285.9041683464275], [285.9497684908632], [285.9418496390068], [285.99059707631744], [286.0214953696285], [286.00253151709944], [285.96506257618194], [285.95530453602885], [286.07563895135075], [286.04355511995857], [286.03986513703967], [285.97223347629296], [286.16329286114484], [286.1779396205375], [286.1729632419597], [286.05366317193506], [286.20170516841785], [286.03734853048957], [286.0904378478406], [286.2363842186654], [286.18002120415906], [286.10572943971505], [286.1715554534932], [286.1519241643232], [286.2253959312257], [286.2022569427093], [286.1237873532291], [286.16795287913595], [286.1994276279804], [286.21295543185687], [286.28924575421854], [286.1162771010676], [286.17822874442516], [286.15528641111274], [286.21939075240715], [286.1829092804922], [286.298881299216], [286.35518618500794], [286.3136160289409], [286.4416570932139], [286.2483527141508], [286.25076470670217], [286.387992864208], [286.3238672888996], [286.30504600521107], [286.4666280685184], [286.45926709824727], [286.35833115239853], [286.33529232992174], [286.4030124704784], [286.42876841994234], [286.4265276201607]])
y = np.array([31.82082490529877,30.095264211096985,30.8671131573908,30.75302676007411,33.48412384835502,30.41492978051738,32.94540243476157,30.761204731747725,33.4442703416498,32.97526127985182,36.73731599245168,31.866547262868792,30.73327750955997,32.746070524263644,29.194812566183767,31.831984689888067,30.012200651364758,29.432917877505822,32.233026367717166,30.720422049654275,31.93691350655172,31.678306988982367,32.60576551581113,31.190576476530826,32.26209285196356,31.635163649255464,32.428866552117064,33.1831462278562,30.627622806094816,27.3224659293558,30.538450993090944,25.263485426631068,32.74137922813012,31.07839705355212,26.462609937761066,29.13799630284108,29.39525848644947,28.609786599926963,33.24025766426006,28.19002470773531,31.76561334240621,32.608874691756505,28.483299793855384,26.55898840009497,28.34004748706765,28.33209710758726,25.56523225104832,27.791963029943656,27.728687664696544,24.635928666441103,29.53581460664364,29.241181859481376,28.524029113092546,28.21816599575969,23.97643741218427,27.989380668858058,27.050751547056244,28.25275580116992,29.689680588094983,32.38235140054391,27.909418013311797,28.8702060185856,28.113257163255703,30.700902979452746,27.612577863513422,31.941146120915608,30.55657054484518,28.3939787863724,26.32921983110876,25.70959809535412,28.96796752838892,30.983972482325264,24.36618357188154,28.56210944213008,27.561654068231533,33.634343280967215,31.23828949153052,32.353431809406885,31.19198040694858])
nb_samples = 5
X = X[:5, :]
y = y[:5]
model = PySRRegressor(parallelism='serial', random_state=0, deterministic=True,
                      niterations=1, precision=64)
model.fit(X, y)
print(f'{len(model.equations_)} equations with complexity: {model.equations_['complexity'].to_list()}')
print(f'with loss list={model.equations_["loss"].to_list()}')



